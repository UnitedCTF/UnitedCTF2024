<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Shellcode obfuscation</title>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous" />

    <script src="/index.js"></script>
</head>

<body>
    <div class="container bg-light mb-5">
        <h1 class="text-center">Shellcode obfuscation</h1>
        <div class="row instructions d-flex">
            <h3 class="text-center">Instructions</h3>
            <div class="row d-flex justify-content-center">
                <div class="col-6">
                    1. Pour chaque niveau, vous devez executer du code qui va imprimer
                    le string "Hello world" sur STDOUT.<br />
                    2. Les seuls syscalls permis sont read sur stdin, write sur
                    stdout/stderr, exit et sigreturn.<br />
                    3. Le shellcode qui va etre executé doit etre en dessous de 75 bytes
                    de long.<br />
                    4. L'architecture est AMD64.<br />
                    5. Le format du shellcode doit etre en hexadécimal
                    (\x00\x01\x02).<br /><br />
                </div>
            </div>
            <h3 class="text-center">Instructions</h3>
            <div class="row d-flex justify-content-center">
                <div class="col-6">
                    1. For each level, you must execute code that will print the string
                    "Hello world" on STDOUT.<br />
                    2. The only syscalls allowed are read on stdin, write on
                    stdout/stderr, exit and sigreturn.<br />
                    3. The shellcode that will be executed must be less than 75 bytes
                    long.<br />
                    4. The architecture is AMD64.<br />
                    5. The shellcode format must be in hexadecimal (\x00\x01\x02).<br />
                </div>
            </div>
        </div>
        <div class="level1 row mt-5 p-0">
            <h3 class="text-center bg-dark text-light py-3">Level 1</h3>
            <h4 class="col-12">Bytes:</h4>
            <h5>Restrictions sur le bytecode:</h5>
            <p>Il n'y a aucune restriction pour ce niveau.</p>
            <h5>Bytecode restrictions:</h5>
            <p>There are no restrictions for this level.</p>
            <div class="d-flex justify-content-center">
                <textarea id="level1_bytes" class="form-control col-12" rows="3"></textarea>
            </div>
            <div class="row d-flex justify-content-center">
                <button class="btn btn-primary mt-4 col-5" onclick="execute(1)">
                    Execute
                </button>
            </div>
            <h4 class="col-12">Output:</h4>
            <div class="d-flex justify-content-center">
                <textarea id="level1_output" class="form-control col-12" rows="3" readonly></textarea>
            </div>
        </div>
        <div class="level2 row mt-5 p-0">
            <h3 class="text-center bg-dark text-light py-3">Level 2</h3>
            <h4 class="col-12">Bytes:</h4>
            <h5>Restrictions sur le bytecode:</h5>
            <p>Les bytes suivants sont interdits:\x0f\x05\x31\x89</p>
            <h5>Bytecode restrictions:</h5>
            <p>The following bytes are forbidden:\x0f\x05\x31\x89</p>
            <div class="d-flex justify-content-center">
                <textarea id="level2_bytes" class="form-control col-12" rows="3"></textarea>
            </div>
            <h4 class="col-12">Operations:</h4>
            <p>
                Vous pouvez effectuer des opérations sur les bytes en python à
                l'aide de la compréhension de liste pour les transformer en
                format executable. <br />Attention, assurez vous que les bytes
                soient biens formattés et que l'output soit une liste d'integer
                qui correspond a votre shellcode a executer.
            </p>

            <br />
            <p>
                You can perform operations on the bytes in python using list
                comprehension to transform them into an executable format.
                <br />Be careful, make sure the bytes are well formatted and
                that the output is a list of integers that corresponds to your
                shellcode to execute.
            </p>
            <br />
            <h5>Restrictions sur les opérations:</h5>
            <p>
                La liste de keyword suivante est interdite:
                <br />["import","=","def","exec","eval","compile","os","global","try","expect","finally","\\"]
            </p>
            <h5>Operations restrictions:</h5>
            <p>
                The following keyword list is forbidden:
                <br />["import","=","def","exec","eval","compile","os","global","try","expect","finally","\\"]
            </p>
            <div class="d-flex justify-content-center">
                <textarea id="level2_operations" class="form-control col-12" rows="3" oninput="operation(2)"></textarea>
            </div>
            <p id="level2_op_output"></p>
            <div class="row d-flex justify-content-center">
                <button class="btn btn-primary mt-4 col-5" onclick="execute(2)">
                    Execute
                </button>
            </div>
            <h4 class="col-12">Output:</h4>
            <div class="d-flex justify-content-center">
                <textarea id="level2_output" class="form-control col-12" rows="3" readonly></textarea>
            </div>
        </div>
        <div class="level3 row mt-5 p-0">
            <h3 class="text-center bg-dark text-light py-3">Level 3</h3>
            <h4 class="col-12">Bytes:</h4>
            <h5>Restrictions sur le bytecode:</h5>
            <p>Les bytes suivants sont interdits:\x0f\x05\x31\x89</p>
            <h5>Bytecode restrictions:</h5>
            <p>The following bytes are forbidden:\x0f\x05\x31\x89</p>
            <div class="d-flex justify-content-center">
                <textarea id="level3_bytes" class="form-control col-12" rows="3"></textarea>
            </div>
            <h4 class="col-12">Operations:</h4>
            <h5>Restrictions sur les opérations:</h5>
            <p>
                La liste de keyword suivante est interdite:
                <br />["import","=","def","exec","eval","compile","os","global","try","expect","finally","\\","+","-","^","*","/","%","//"]
            </p>
            <h5>Operations restrictions:</h5>
            <p>
                The following keyword list is forbidden:
                <br />["import","=","def","exec","eval","compile","os","global","try","expect","finally","\\","+","-","^","*","/","%","//"]
            </p>
            <div class="d-flex justify-content-center">
                <textarea id="level3_operations" class="form-control col-12" rows="3" oninput="operation(3)"></textarea>
            </div>
            <p id="level3_op_output"></p>
            <div class="row d-flex justify-content-center">
                <button class="btn btn-primary mt-4 col-5" onclick="execute(3)">
                    Execute
                </button>
            </div>
            <h4 class="col-12">Output:</h4>
            <div class="d-flex justify-content-center">
                <textarea id="level3_output" class="form-control col-12" rows="3" readonly></textarea>
            </div>
        </div>
        <div class="level4 row mt-5 pb-5 p-0">
            <h3 class="text-center bg-dark text-light py-3">Level 4</h3>
            <h4 class="col-12">Bytes:</h4>
            <h5>Restrictions sur le bytecode:</h5>
            <p>Les bytes suivants sont interdits:\x0f\x05</p>
            <h5>Bytecode restrictions:</h5>
            <p>The following bytes are forbidden:\x0f\x05</p>
            <div class="d-flex justify-content-center">
                <textarea id="level4_bytes" class="form-control col-12" rows="3"></textarea>
            </div>
            <h4 class="col-12">Operations:</h4>
            <h5>Aucune opération permise</h5>
            <h5>No operations allowed</h5>
            <div class="row d-flex justify-content-center">
                <button class="btn btn-primary mt-4 col-5" onclick="execute(4)">
                    Execute
                </button>
            </div>
            <h4 class="col-12">Output:</h4>
            <div class="d-flex justify-content-center">
                <textarea id="level4_output" class="form-control col-12" rows="3" readonly></textarea>
            </div>
        </div>
    </div>
</body>

</html>