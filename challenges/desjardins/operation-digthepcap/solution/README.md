# DigThePCAP

## 1

strings red.pcap | grep FLAG

`FLAG-FTPisNotSecure`

## 2

```
SERVER_HANDSHAKE_TRAFFIC_SECRET b745e0d839b50d4861d09e8c8e301ea9418e87ef94261101cf7ad3e95d057bc6 eb4ca1c86c7a2dcfc4ac6de5c662c76bf99c96c9c216b23d8e2ad2082ab2a4e19ac3fd8fd46821f2e0c1833b981fd402
EXPORTER_SECRET b745e0d839b50d4861d09e8c8e301ea9418e87ef94261101cf7ad3e95d057bc6 1109376a0a6ef28bc6182f9bb54c962070191e563d3afa819f6a17a014f415769a730b9384f3d63b5253fc50fe707378
SERVER_TRAFFIC_SECRET_0 b745e0d839b50d4861d09e8c8e301ea9418e87ef94261101cf7ad3e95d057bc6 c16d845a60d27a93b9159f17ed60beee0a4da55787a483e45df6dacf4320311bc61f3aaa1b7fa968b63699eecf2b0a3e
CLIENT_HANDSHAKE_TRAFFIC_SECRET b745e0d839b50d4861d09e8c8e301ea9418e87ef94261101cf7ad3e95d057bc6 7b4a0f815b17b84caa2e2738ac7979ad55db7bb0ec3b9e8452c4ff6f046dec6324159a58fc2bbc5d5f62fc0485823f0f
CLIENT_TRAFFIC_SECRET_0 b745e0d839b50d4861d09e8c8e301ea9418e87ef94261101cf7ad3e95d057bc6 b212dd7d997bb87d93d1c06a8fb3cb0913cf9e0cbc89dde349bdf2dd22b1c07692b02160d0f0a877a73190b6b1f3491b
SERVER_HANDSHAKE_TRAFFIC_SECRET 7f20dece50a147518e795472e54457591d60fe9a2e2ddf39022c6f453a3dadf7 55951f72d6659f6c45f839238e2dc43e8b5f66b37cb4de19afdc91eddac9ee04bb2ceae44788a76b2274ae0f6f1e81a1
EXPORTER_SECRET 7f20dece50a147518e795472e54457591d60fe9a2e2ddf39022c6f453a3dadf7 e67f9e22b88c04404a8d327d228e07e7244bc399e6fe5424680e6267eadb90521e88d464c46247b6fe9f790fb96ad475
SERVER_TRAFFIC_SECRET_0 7f20dece50a147518e795472e54457591d60fe9a2e2ddf39022c6f453a3dadf7 d0d6b98ecba2283c1494f70d31e554cf77b4231dc0027e8c8df3e30c0a86743416647becdfeb99746716b03c20468d97
CLIENT_HANDSHAKE_TRAFFIC_SECRET 7f20dece50a147518e795472e54457591d60fe9a2e2ddf39022c6f453a3dadf7 34114a812138e1e7e110819b273d8f61410da04c80ca55635f6645525366b8879ce5d29b9ea60ec9cd24eab0a9da2fbb
CLIENT_TRAFFIC_SECRET_0 7f20dece50a147518e795472e54457591d60fe9a2e2ddf39022c6f453a3dadf7 826ab7c714750bfbf3da0090d8ebd5519a40be2bfbd72d3bb641c4304431a433f9aaca1923915184d6d8ce361f927b36
```

| Key                             | Client                                                           | Value                                                                                            |
| ------------------------------- | ---------------------------------------------------------------- | ------------------------------------------------------------------------------------------------ |
| SERVER_HANDSHAKE_TRAFFIC_SECRET | b745e0d839b50d4861d09e8c8e301ea9418e87ef94261101cf7ad3e95d057bc6 | eb4ca1c86c7a2dcfc4ac6de5c662c76bf99c96c9c216b23d8e2ad2082ab2a4e19ac3fd8fd46821f2e0c1833b981fd402 |
| EXPORTER_SECRET                 | b745e0d839b50d4861d09e8c8e301ea9418e87ef94261101cf7ad3e95d057bc6 | 1109376a0a6ef28bc6182f9bb54c962070191e563d3afa819f6a17a014f415769a730b9384f3d63b5253fc50fe707378 |
| SERVER_TRAFFIC_SECRET_0         | b745e0d839b50d4861d09e8c8e301ea9418e87ef94261101cf7ad3e95d057bc6 | c16d845a60d27a93b9159f17ed60beee0a4da55787a483e45df6dacf4320311bc61f3aaa1b7fa968b63699eecf2b0a3e |
| CLIENT_HANDSHAKE_TRAFFIC_SECRET | b745e0d839b50d4861d09e8c8e301ea9418e87ef94261101cf7ad3e95d057bc6 | 7b4a0f815b17b84caa2e2738ac7979ad55db7bb0ec3b9e8452c4ff6f046dec6324159a58fc2bbc5d5f62fc0485823f0f |
| CLIENT_TRAFFIC_SECRET_0         | b745e0d839b50d4861d09e8c8e301ea9418e87ef94261101cf7ad3e95d057bc6 | b212dd7d997bb87d93d1c06a8fb3cb0913cf9e0cbc89dde349bdf2dd22b1c07692b02160d0f0a877a73190b6b1f3491b |
| SERVER_HANDSHAKE_TRAFFIC_SECRET | 7f20dece50a147518e795472e54457591d60fe9a2e2ddf39022c6f453a3dadf7 | 55951f72d6659f6c45f839238e2dc43e8b5f66b37cb4de19afdc91eddac9ee04bb2ceae44788a76b2274ae0f6f1e81a1 |
| EXPORTER_SECRET                 | 7f20dece50a147518e795472e54457591d60fe9a2e2ddf39022c6f453a3dadf7 | e67f9e22b88c04404a8d327d228e07e7244bc399e6fe5424680e6267eadb90521e88d464c46247b6fe9f790fb96ad475 |
| SERVER_TRAFFIC_SECRET_0         | 7f20dece50a147518e795472e54457591d60fe9a2e2ddf39022c6f453a3dadf7 | d0d6b98ecba2283c1494f70d31e554cf77b4231dc0027e8c8df3e30c0a86743416647becdfeb99746716b03c20468d97 |
| CLIENT_HANDSHAKE_TRAFFIC_SECRET | 7f20dece50a147518e795472e54457591d60fe9a2e2ddf39022c6f453a3dadf7 | 34114a812138e1e7e110819b273d8f61410da04c80ca55635f6645525366b8879ce5d29b9ea60ec9cd24eab0a9da2fbb |
| CLIENT_TRAFFIC_SECRET_0         | 7f20dece50a147518e795472e54457591d60fe9a2e2ddf39022c6f453a3dadf7 | 826ab7c714750bfbf3da0090d8ebd5519a40be2bfbd72d3bb641c4304431a433f9aaca1923915184d6d8ce361f927b36 |

https://wiki.wireshark.org/TLS#using-the-pre-master-secret

Then import the FLAG-FTPisNotSecure.log as Pre-Master-Secret file. Then search for FLAG. We find a new HTTP route name /get_flag which returns: FLAG-FINCTFisONEStepClosertoNSEC.

## 3

We can see a new route name /get_stager. Potentially a staged reverse shell like a meterpreter staged shell.

```shell
file get_stager
get_stager: DOS executable (COM)
```
