#!/bin/bash
set -euo pipefail
cd "$(dirname -- "$( readlink -f -- "$0"; )")"

TMPF=$(mktemp)
trap "rm $TMPF" EXIT

cat payload.js | \
  (nc 127.0.0.1 1234 || (cd ..; node ./challenge.js)) >$TMPF
  
grep -oE 'flag-([0-9a-f])+' "$TMPF"
