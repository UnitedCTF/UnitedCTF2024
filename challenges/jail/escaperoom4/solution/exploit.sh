#!/bin/bash
set -euo pipefail
cd "$(dirname -- "$( readlink -f -- "$0"; )")"

TMPF=$(mktemp)
trap "rm $TMPF" EXIT

# see README.md
cat payload.js | \
  (nc 127.0.0.1 1237 || (cd ..; node ./challenge.js)) >$TMPF

grep -oE '([0-9]+,)+[0-9]+' "$TMPF" | \
  node -e "console.log(String.fromCharCode(...require('fs').readFileSync('/dev/stdin').toString().split(',')))"
